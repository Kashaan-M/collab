import{u as N,r as t,a as S,j as e}from"./index-3e17390d.js";import{N as A,B as E,M as I}from"./Btn-af5112b3.js";import{F as R}from"./Footer-ec8f36c7.js";import{A as w,I as o}from"./Alert-d9b93f88.js";import{a as k}from"./axios-71af5128.js";function M(){const{isSignedIn:F,setIsSignedIn:j}=N(),[u,i]=t.useState(""),[c,d]=t.useState(""),[m,f]=t.useState(""),[g,x]=t.useState(""),l=t.useRef(null),n=t.useRef(null),a=t.useRef(null),v=S(),b="appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:border-2 focus:border-blue-500 focus:bg-white";t.useEffect(()=>{a.current&&a.current.setAttribute("disabled",!0)},[]),t.useEffect(()=>{m&&g?a.current.removeAttribute("disabled"):a.current.setAttribute("disabled",!0)},[m,g]);async function y(s){var p,h;s.preventDefault();try{const{data:r}=await k.post("/api/login",{email:l.current.value,password:n.current.value});r.msg&&(d(r.msg),j(!0),sessionStorage.setItem("signedIn",!0),setTimeout(()=>{v("/dashboard")},2e3))}catch(r){r.response.data.msg&&i((h=(p=r.response)==null?void 0:p.data)==null?void 0:h.msg),console.log("something went wrong")}finally{f(""),x(""),setTimeout(()=>{i(""),d("")},2e3)}}return e.jsxs(e.Fragment,{children:[e.jsx(A,{children:e.jsx(E,{text:"Sign up",href:"/users/new"})}),e.jsxs(I,{children:[" ",u?e.jsx(w,{error:u}):c?e.jsx(w,{success:c}):null,e.jsxs("form",{onSubmit:async s=>await y(s),children:[e.jsx("div",{className:"w-full max-w-lg",children:e.jsxs("div",{className:"w-full px-3",children:[e.jsx("label",{className:"block uppercase tracking-wide text-gray-700 text-md font-bold mb-2",htmlFor:"user_email",children:"Email"}),e.jsx(o,{ref:l,className:b,type:"email",name:"email",id:"user_email",onChange:s=>{l.current.setAttribute("value",s.target.value),x(s.target.value)},required:!0})]})}),e.jsx("div",{className:"w-full max-w-lg",children:e.jsxs("div",{className:"w-full px-3",children:[e.jsx("label",{className:"block uppercase tracking-wide text-gray-700 text-md font-bold mb-2",htmlFor:"user_password",children:"Password"}),e.jsx(o,{ref:n,className:b,minLength:"7",maxLength:"20",type:"password",name:"password",id:"user_password",onChange:s=>{n.current.setAttribute("value",s.target.value),f(s.target.value)},required:!0})]})}),e.jsx("div",{className:"w-full max-w-lg",children:e.jsx("div",{className:"w-full px-3",children:e.jsx(o,{ref:a,type:"submit",name:"commit",value:"Log in",className:"bg-blue-500 disabled:bg-slate-300 disabled:text-gray-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"})})})]})]}),e.jsx(R,{})]})}export{M as default};
